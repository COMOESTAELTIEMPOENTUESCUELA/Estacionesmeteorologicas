<!DOCTYPE html>
<html>
  <head>
    <title>Mapa de Estaciones con Leaflet y ThingSpeak</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <style>
      #map { height: 500px; }
      #dashboard {
        display: flex;
        justify-content: space-around;
        margin-bottom: 10px;
      }
      .panel {
        padding: 10px;
        border: 1px solid #ccc;
        text-align: center;
        width: 20%;
      }
      #logo {
        display: block;
        margin: 0 auto;
        width: 100px;
      }
    </style>
  </head>
  <body>
    <img id="logo" src="Logo1.jpg" alt="Logo del Proyecto">
    <h2>Estaciones de ThingSpeak en el Mapa</h2>
    <div id="dashboard">
      <div class="panel" id="temp">Temperatura: -- °C</div>
      <div class="panel" id="hum">Humedad: -- %</div>
      <div class="panel" id="pres">Presión: -- hPa</div>
      <div class="panel" id="prec">Precipitación: -- mm</div>
    </div>
    <div id="map"></div>
    <script>
      var map = L.map('map').setView([-34.943601567561295, -57.89445690196709], 13);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; OpenStreetMap contributors'
      }).addTo(map);

      const url = 'https://api.thingspeak.com/channels/2685796/feeds.json?api_key=P3H82TMM9GH1NS26&results=1';

      fetch(url)
        .then(response => response.json())
        .then(data => {
          const feed = data.feeds[0];
          document.getElementById('temp').innerText = `Temperatura: ${feed.field1} °C`;
          document.getElementById('hum').innerText = `Humedad: ${feed.field2} %`;
          document.getElementById('pres').innerText = `Presión: ${feed.field3} hPa`;
          document.getElementById('prec').innerText = `Precipitación: ${feed.field4} mm`;

          const latitud = -34.943601567561295;
          const longitud = -57.89445690196709;
          var marker = L.marker([latitud, longitud]).addTo(map);
          marker.bindPopup(`<b>Estación</b><br>Temperatura: ${feed.field1}°C`).openPopup();
          map.setView([latitud, longitud], 13);
        })
        .catch(error => console.error('Error al obtener los datos de ThingSpeak:', error));
    </script>
  </body>
</html>


